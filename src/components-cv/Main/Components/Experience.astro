---
import SectionScheme from "@/utils/Section-Scheme.astro";
import ItemExperience from "@/utils/Item-WSVA.astro";

import { formatYears } from "@/assets/js/Format-Time";
import { getRepos } from "@/api/acces_api";

const developer = await getRepos().then((repos) => {
  return repos.map((res: any) => {
    const startDate = res.startDate;
    const endDate = res.endDate || null;

    const date = formatYears(startDate, endDate);

    return {
      title: res.name || "Título no disponible",
      date: date,
      description: res.description || "Descripción no disponible",
      download: res.html_url || "URL no disponible",
      badge: "latest " + res.language || "Sin destacados",
    };
  });
});
---

<SectionScheme id="" className="pb-10 gap-4">
  <header>
    <h1 class="text-2xl text-black font-bold">Experiencia</h1>
  </header>
  <div class="text-gray-900 list-none flex flex-col gap-4">
    {
      developer.map((dev: any) => (
        <ItemExperience
          name={dev.title}
          position="Programador"
          years={dev.date}
          summary={dev.description}
        />
      ))
    }
  </div>
</SectionScheme>
